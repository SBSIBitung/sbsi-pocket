<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBSI Pocket Pro</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        :root { --sbsi-red: #dc3545; --bg-soft: #f4f7f6; }
        body { background: var(--bg-soft); font-family: 'Segoe UI', sans-serif; }
        .card-profile { border: none; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .profile-img { width: 110px; height: 110px; object-fit: cover; border-radius: 50%; border: 4px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-top: -55px; }
        .data-box { background: #fff; padding: 12px; border-radius: 12px; margin-bottom: 10px; border: 1px solid #eee; }
        .data-label { font-size: 0.7rem; font-weight: 800; color: #999; text-transform: uppercase; }
        .data-val { font-size: 0.95rem; font-weight: 600; color: #333; }

        @media print {
            #mainNav, .btn, #st1, #st2, .no-print, #loading { display: none !important; }
            body { background: white !important; }
            #pdf-area { display: block !important; border: none !important; width: 100% !important; }
        }
    </style>
</head>
<body>

<div id="loading" class="position-fixed w-100 h-100 d-flex justify-content-center align-items-center bg-white" style="z-index:9999">
    <div class="spinner-border text-danger"></div>
</div>

<nav id="mainNav" class="navbar navbar-expand sticky-top bg-white border-bottom d-none">
    <div class="container justify-content-center">
        <div class="navbar-nav">
            <a class="nav-link px-4 fw-bold active" id="l1" href="#" onclick="showTab('tab1','l1')">PROFIL</a>
            <a class="nav-link px-4 fw-bold" id="l2" href="#" onclick="showTab('tab2','l2')">AUDIT</a>
        </div>
    </div>
</nav>

<div id="secMain" class="container py-4 d-none">
    <div id="tab1" class="tab-content">
        <div class="card card-profile mx-auto overflow-hidden" style="max-width: 450px;">
            <div style="height: 90px; background: linear-gradient(45deg, #dc3545, #ff5f6d);"></div>
            <div class="card-body text-center pt-0">
                <img id="uFoto" src="" class="profile-img bg-light mb-3">
                <h4 id="uNama" class="fw-bold mb-0"></h4>
                <p id="uNik" class="text-muted small mb-4"></p>
                <div class="text-start">
                    <div class="data-box"><div class="data-label">Tempat, Tgl Lahir</div><div id="uTtl" class="data-val"></div></div>
                    <div class="data-box"><div class="data-label">Alamat Lengkap</div><div id="uAlamat" class="data-val"></div></div>
                </div>
                <button class="btn btn-outline-danger w-100 mt-3 btn-sm" onclick="doLogout()">LOGOUT</button>
            </div>
        </div>
    </div>

    <div id="tab2" class="tab-content d-none">
        <div class="card card-profile p-4 bg-white mx-auto shadow-sm" style="max-width: 600px;">
            <div id="st1">
                <h5 class="fw-bold mb-4">Analisis Hak Pekerja</h5>
                <div class="row g-2 mb-4">
                    <div class="col-6"><label class="small fw-bold">MULAI KERJA</label><input type="date" id="t1" class="form-control"></div>
                    <div class="col-6"><label class="small fw-bold">TANGGAL PHK</label><input type="date" id="t2" class="form-control"></div>
                </div>
                <button class="btn btn-primary w-100 py-3 fw-bold" onclick="genGaji()">INPUT RINCIAN UPAH</button>
            </div>

            <div id="stRes" class="d-none">
                <div id="pdf-area">
                    <div class="text-center mb-4 border-bottom pb-3">
                        <img src="Logo_SBSI.png" width="60" class="mb-2">
                        <h5 class="fw-bold mb-0">HASIL PERHITUNGAN MANDIRI</h5>
                        <p class="small fw-bold text-uppercase">FSBSI DPC KOTA BITUNG</p>
                    </div>
                    <table class="table table-sm small">
                        <tr><td>Nama Pekerja</td><td class="fw-bold" id="rNm"></td></tr>
                        <tr><td>Masa Kerja</td><td id="rPrd"></td></tr>
                        <tr class="table-primary fw-bold"><td>Pesangon (<span id="oD"></span>)</td><td class="text-end" id="oP"></td></tr>
                        <tr class="table-danger fw-bold h5 text-danger"><td class="py-3">TOTAL HAK</td><td class="text-end py-3" id="oTot"></td></tr>
                    </table>
                    <div class="mt-5 text-end small">
                        <p>Bitung, <span id="curTgl"></span><br>Pekerja,</p>
                        <br><br><b id="signNama"></b>
                    </div>
                </div>
                <div class="row g-2 mt-4 no-print">
                    <div class="col-6"><button class="btn btn-success w-100 py-3 fw-bold" onclick="window.print()"><i class="bi bi-printer"></i> PRINT / PDF</button></div>
                    <div class="col-6"><button class="btn btn-outline-secondary w-100 py-3" onclick="location.reload()">ULANGI</button></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const API = "URL_WEB_APP_ANDA";
    let USER = null;

    window.onload = function() {
        const saved = localStorage.getItem('sbsi_user');
        if (saved) { USER = JSON.parse(saved); showMain(); } 
        else { document.getElementById('secLogin').classList.remove('d-none'); }
        document.getElementById('loading').classList.add('d-none');
    };

    function showMain() {
        document.getElementById('mainNav').classList.remove('d-none');
        document.getElementById('secMain').classList.remove('d-none');
        document.getElementById('uNama').innerText = USER.nama;
        document.getElementById('uNik').innerText = "NIK: " + USER.nik;
        document.getElementById('uTtl').innerText = USER.tempat + ", " + USER.tglLahir;
        document.getElementById('uAlamat').innerText = USER.alamat;
        document.getElementById('uFoto').src = USER.foto || "https://via.placeholder.com/150";
    }

    function showTab(t, l) {
        document.querySelectorAll('.tab-content').forEach(x => x.classList.add('d-none'));
        document.querySelectorAll('.nav-link').forEach(x => x.classList.remove('active'));
        document.getElementById(t).classList.remove('d-none');
        document.getElementById(l).classList.add('active');
    }
    // ... (Fungsi login dan proses perhitungan tetap sama)
</script>
</body>
</html>
